<!DOCTYPE html>
<html>
    <head>
        <title><%= exercise.name %></title>
        <link rel="stylesheet" href="/style.css">
    </head>
    <body>
        <% const params = JSON.parse(exercise.checklist); %>

        <img src="/exercises/img/<%= exercise.illustration_sequence %>.jpg" alt="<%= exercise.name %>" style="max-width: 300px;">
        <H1><%= exercise.name %></H1>
        <br>
        <h2>Client`s aim</h2>
        <p>To strengthen the muscles that straighten your leg.</p>
        <br>
        <h2>Client`s instructions</h2>
        <p>Position yourself standing. Practice sliding back and forwards with your unaffected leg. Ensure that both feet point forwards and the weight is mostly on the front leg. Ensure your front knee bends in line with the foot and you keep your pelvis level.</p>

        <h3>Perform <%= params.reps %> sets of <%= params.duration %> reps/duration</h3>
        <h3>Do <%= params.perWeek %> sessions per week</h3>

        <div id="timer-widget">
            <h2>Exercise Timer: <span id="time-display">Ready</span></h2>
            <button id="start-timer">Start Timer</button>
        </div>

        <script>
            const duration = parseInt('<%= params.duration %>', 10);            let timeRemaining = duration * 60; // Convert to seconds
            const timeDisplay = document.getElementById('time-display');
            const startButton = document.getElementById('start-timer');
            let timerInterval;

            function updateTimer() {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;

                timeDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    timeDisplay.textContent = "TIME UP!";
                    startButton.disabled = true;
                } else {
                    timeRemaining--;
                }
            }

            startButton.addEventListener('click', () => {
                if (timerInterval) clearInterval(timerInterval); // Reset if already running
                timeRemaining = duration * 60; // Reset time
                startButton.disabled = true;
                timerInterval = setInterval(updateTimer, 1000);
                updateTimer(); 
            });
            
            // Initial setup
            const initialMinutes = Math.floor(timeRemaining / 60);
            timeDisplay.textContent = `${initialMinutes}:00`;
        </script>
    </body>
</html>